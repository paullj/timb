import{S as Ae,i as Te,s as Re,l as $,g as M,e as E,k as O,c as k,a as I,m as P,d as f,b as u,L as se,J as p,M as ee,t as G,h as Q,j as fe,f as j,N as te,O as z,P as oe,K as ae,Q as Ie,v as Me,R as le,T as me,U as Fe,V as _e,W as we,X as Le,Y as Ue}from"../chunks/vendor-21b950d3.js";const Z=[{comments:["timb - NICE TAGLINE","click on the dots above to see more!"],code:"[[0,4,7,9].map(n=>f(220,n))[m%2+b%3],[55,69][r(1,5)[i%5]]]"},{comments:["each dot is a beat, to play a note","return a frequency from 20-20000 hz"],code:"440"},{comments:["`m` is the current measure (0-8)","and `b`, the beat in the current mesasure (0-8)"],code:"(1+m%2)*110*[1,2,3,4][b%4]"},{comments:["`t` is time","and `i` is index (0-8)"],code:"440+t*[0,1,2,1][i%4]"},{comments:["NaN and other non number values are rest notes","this allows for intesting rhythms"],code:"440*[2,NaN,1,NaN,1,1][i%6]"},{comments:["return an array plays a chord","there is max polyphony of 4"],code:"[[440,220,110],[220,110,880]][m%2]"},{comments:["`f(b,i)` gives frequency from `i` semitones & base frequency `b`","440Hz is A4. MAKETHISBETTER"],code:"[0,3,5,7].map(n=>f(440,n))[b%4]"},{comments:["`r(o,t)` gives indexes for euclidean rhythm patterns","where `o` is FIXME & `t` is FIXME"],code:"[NaN,440][r(3,8)[b]]"},{comments:["`Math` functions are available in scope","WRITE SOMETHING INTERESTING"],code:"440+110*sin(t)+220*cos(2*t)"},{comments:["an attempt at twinkle twinkle little star","can you make a smaller one?"],code:"[...'0077997~5544220~7755442~7755442~'].map(n=>f(440,n))[i%32]"},{comments:["now its your turn","remember that you are limited to 64 bytes"],code:"'HAVE FUN :)'"}];function pe(a,e,t){const l=a.slice();return l[20]=e[t],l}function de(a,e,t){const l=a.slice();return l[23]=e[t],l[25]=t,l}function be(a,e,t){const l=a.slice();l[23]=e[t],l[30]=t;const o=l[5]*L+l[6];l[26]=o;const n=x*l[25]+l[30];l[27]=n;const s=l[8](l[4],l[27],l[25],l[30]).sort(De);return l[28]=s,l}function ve(a,e,t){const l=a.slice();return l[23]=e[t],l[32]=t,l}function Se(a){let e;return{c(){e=E("div"),this.h()},l(t){e=k(t,"DIV",{class:!0,style:!0}),I(e).forEach(f),this.h()},h(){u(e,"class","note svelte-1xpsne7"),j(e,"--index",a[32]),j(e,"--scale",a[9](a[28][a[32]])),se(e,"overlay",a[32]>0)},m(t,l){M(t,e,l)},p(t,l){l[0]&272&&j(e,"--scale",t[9](t[28][t[32]]))},d(t){t&&f(e)}}}function qe(a){let e;return{c(){e=E("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),I(e).forEach(f),this.h()},h(){u(e,"class","note rest svelte-1xpsne7")},m(t,l){M(t,e,l)},p:ae,d(t){t&&f(e)}}}function ge(a){let e,t;function l(s,c){return c[0]&272&&(e=null),e==null&&(e=!!(s[28][s[32]]===null||Number.isNaN(s[28][s[32]]))),e?qe:Se}let o=l(a,[-1,-1]),n=o(a);return{c(){n.c(),t=$()},l(s){n.l(s),t=$()},m(s,c){n.m(s,c),M(s,t,c)},p(s,c){o===(o=l(s,c))&&n?n.p(s,c):(n.d(1),n=o(s),n&&(n.c(),n.m(t.parentNode,t)))},d(s){n.d(s),s&&f(t)}}}function ye(a){let e,t,l={length:a[28].length||0},o=[];for(let n=0;n<l.length;n+=1)o[n]=ge(ve(a,l,n));return{c(){e=E("div");for(let n=0;n<o.length;n+=1)o[n].c();t=O(),this.h()},l(n){e=k(n,"DIV",{class:!0});var s=I(e);for(let c=0;c<o.length;c+=1)o[c].l(s);t=P(s),s.forEach(f),this.h()},h(){u(e,"class","beat svelte-1xpsne7"),se(e,"indicator",a[26]===a[27])},m(n,s){M(n,e,s);for(let c=0;c<o.length;c+=1)o[c].m(e,null);p(e,t)},p(n,s){if(s[0]&784){l={length:n[28].length||0};let c;for(c=0;c<l.length;c+=1){const N=ve(n,l,c);o[c]?o[c].p(N,s):(o[c]=ge(N),o[c].c(),o[c].m(e,t))}for(;c<o.length;c+=1)o[c].d(1);o.length=l.length}s[0]&96&&se(e,"indicator",n[26]===n[27])},d(n){n&&f(e),ee(o,n)}}}function Ee(a){let e,t={length:L},l=[];for(let o=0;o<t.length;o+=1)l[o]=ye(be(a,t,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=$()},l(o){for(let n=0;n<l.length;n+=1)l[n].l(o);e=$()},m(o,n){for(let s=0;s<l.length;s+=1)l[s].m(o,n);M(o,e,n)},p(o,n){if(n[0]&880){t={length:L};let s;for(s=0;s<t.length;s+=1){const c=be(o,t,s);l[s]?l[s].p(c,n):(l[s]=ye(c),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=t.length}},d(o){ee(l,o),o&&f(e)}}}function ke(a){let e,t,l=a[20]+"",o;return{c(){e=E("label"),t=G("// "),o=G(l),this.h()},l(n){e=k(n,"LABEL",{for:!0,class:!0});var s=I(e);t=Q(s,"// "),o=Q(s,l),s.forEach(f),this.h()},h(){u(e,"for","code"),u(e,"class","comment svelte-1xpsne7")},m(n,s){M(n,e,s),p(e,t),p(e,o)},p(n,s){s[0]&128&&l!==(l=n[20]+"")&&fe(o,l)},d(n){n&&f(e)}}}function Be(a){let e,t,l,o,n,s=a[1].toFixed(1)+"",c,N,m,C,b,U,v,H,S,K,W,q,J,Y,F,A,T,h,g,R,B={length:x},d=[];for(let r=0;r<B.length;r+=1)d[r]=Ee(de(a,B,r));let D=a[7],y=[];for(let r=0;r<D.length;r+=1)y[r]=ke(pe(a,D,r));return{c(){e=E("form"),t=E("button"),l=G("Play"),o=O(),n=E("button"),c=G(s),N=O(),m=E("input"),C=O(),b=E("div");for(let r=0;r<d.length;r+=1)d[r].c();U=O(),v=E("form");for(let r=0;r<y.length;r+=1)y[r].c();H=O(),S=E("label"),K=G("// hit `enter` to save your tune in the URL"),W=O(),q=E("label"),J=G("// to learn more about what you can do click here"),Y=O(),F=E("label"),A=G("(t,i,m,b) =>"),T=O(),h=E("input"),this.h()},l(r){e=k(r,"FORM",{});var _=I(e);t=k(_,"BUTTON",{class:!0});var i=I(t);l=Q(i,"Play"),i.forEach(f),o=P(_),n=k(_,"BUTTON",{class:!0});var V=I(n);c=Q(V,s),V.forEach(f),N=P(_),m=k(_,"INPUT",{type:!0,name:!0,step:!0,min:!0,max:!0,id:!0}),_.forEach(f),C=P(r),b=k(r,"DIV",{class:!0,style:!0});var ce=I(b);for(let X=0;X<d.length;X+=1)d[X].l(ce);ce.forEach(f),U=P(r),v=k(r,"FORM",{class:!0});var w=I(v);for(let X=0;X<y.length;X+=1)y[X].l(w);H=P(w),S=k(w,"LABEL",{for:!0,class:!0});var ie=I(S);K=Q(ie,"// hit `enter` to save your tune in the URL"),ie.forEach(f),W=P(w),q=k(w,"LABEL",{for:!0,class:!0});var ue=I(q);J=Q(ue,"// to learn more about what you can do click here"),ue.forEach(f),Y=P(w),F=k(w,"LABEL",{id:!0,for:!0,class:!0});var he=I(F);A=Q(he,"(t,i,m,b) =>"),he.forEach(f),T=P(w),h=k(w,"INPUT",{id:!0,name:!0,type:!0,spellcheck:!0,autocomplete:!0,class:!0}),w.forEach(f),this.h()},h(){u(t,"class","svelte-1xpsne7"),u(n,"class","mute-button svelte-1xpsne7"),j(n,"text-decoration",a[0]?"line-through":"none",!1),u(m,"type","range"),u(m,"name",""),u(m,"step","0.05"),u(m,"min","0.0"),u(m,"max","1.0"),m.disabled=a[0],u(m,"id",""),u(b,"class","container svelte-1xpsne7"),j(b,"--beats",L),j(b,"--meausures",x),u(S,"for","code"),u(S,"class","comment focused svelte-1xpsne7"),u(q,"for","code"),u(q,"class","comment focused svelte-1xpsne7"),u(F,"id","label"),u(F,"for","input"),u(F,"class","svelte-1xpsne7"),u(h,"id","input"),u(h,"name","code"),u(h,"type","text"),u(h,"spellcheck","false"),u(h,"autocomplete","off"),u(h,"class","svelte-1xpsne7"),u(v,"class","editor svelte-1xpsne7")},m(r,_){M(r,e,_),p(e,t),p(t,l),p(e,o),p(e,n),p(n,c),p(e,N),p(e,m),te(m,a[1]),M(r,C,_),M(r,b,_);for(let i=0;i<d.length;i+=1)d[i].m(b,null);M(r,U,_),M(r,v,_);for(let i=0;i<y.length;i+=1)y[i].m(v,null);p(v,H),p(v,S),p(S,K),p(v,W),p(v,q),p(q,J),p(v,Y),p(v,F),p(F,A),p(v,T),p(v,h),te(h,a[3]),g||(R=[z(t,"click",oe(a[11])),z(n,"click",oe(a[12])),z(m,"change",a[13]),z(m,"input",a[13]),z(b,"click",a[14]),z(h,"input",a[15]),z(v,"submit",oe(a[16]))],g=!0)},p(r,_){if(_[0]&2&&s!==(s=r[1].toFixed(1)+"")&&fe(c,s),_[0]&1&&j(n,"text-decoration",r[0]?"line-through":"none",!1),_[0]&1&&(m.disabled=r[0]),_[0]&2&&te(m,r[1]),_[0]&880){B={length:x};let i;for(i=0;i<B.length;i+=1){const V=de(r,B,i);d[i]?d[i].p(V,_):(d[i]=Ee(V),d[i].c(),d[i].m(b,null))}for(;i<d.length;i+=1)d[i].d(1);d.length=B.length}if(_[0]&128){D=r[7];let i;for(i=0;i<D.length;i+=1){const V=pe(r,D,i);y[i]?y[i].p(V,_):(y[i]=ke(V),y[i].c(),y[i].m(v,H))}for(;i<y.length;i+=1)y[i].d(1);y.length=D.length}_[0]&8&&h.value!==r[3]&&te(h,r[3])},i:ae,o:ae,d(r){r&&f(e),r&&f(C),r&&f(b),ee(d,r),r&&f(U),r&&f(v),ee(y,r),g=!1,Ie(R)}}}const ne=20,re=2e4,L=8,x=8;function Ne(a,e,t){return Math.min(Math.max(a,e),t)}const De=(a,e)=>e-a;function Oe(a,e,t){let l=0,o=0,n=0,s=!1,c=.1,N;Me(()=>{S(),window.f=(h,g)=>h*1.059463**g,window.r=(h,g)=>{for(var R=null,B=[],d=0;d<g;d++){var D=Math.floor(h/g*d);B.push(D===R?0:1),R=D}return B},le().volume.set({value:me(c)}),N=new Fe().toDestination(),N.set({envelope:{attack:.1,decay:.5}}),N.connect(le()),_e.scheduleRepeat(h=>{let g=U(h,o*L+n,o,n);if(Array.isArray(g))g=g.splice(0,4).map(R=>Ne(Number.parseFloat(R),ne,re)).filter(R=>!Number.isNaN(R)),g.length&&N.triggerAttackRelease(g,"8n");else{let R=Number.parseFloat(g);Number.isNaN(R)||N.triggerAttackRelease(Ne(R,ne,re),"8n")}t(5,o=(o+Math.floor((n+1)/L))%x),t(6,n=(n+1)%L)},"8n");let A=requestAnimationFrame(T);function T(){A=requestAnimationFrame(T),t(4,l=we())}return()=>cancelAnimationFrame(A)});let m=0,C=Z[0].comments,b=Z[0].code,U;Array(x).fill().map((A,T)=>Array(L).fill().map((h,g)=>Math.sqrt(((L-g)/L)**2+((x-T)/x)**2)));function v(A,T,h){return Le(1-(A-ne)/(re-ne))}const H=()=>history.pushState(null,"",`#${encodeURIComponent(b)}`),S=()=>{location.hash&&t(3,b=decodeURIComponent(location.hash.slice(1)))},K=()=>_e.toggle(),W=()=>t(0,s=!s);function q(){c=Ue(this.value),t(1,c)}const J=()=>t(2,m=(m+1)%Z.length);function Y(){b=this.value,t(3,b),t(2,m)}const F=()=>{H()};return a.$$.update=()=>{var A,T,h;if(a.$$.dirty[0]&1&&(le().mute=s),a.$$.dirty[0]&2&&((T=(A=le())==null?void 0:A.volume)==null||T.rampTo(me(c),.05)),a.$$.dirty[0]&4&&(t(3,b=Z[m].code),t(7,C=(h=Z[m].comments)!=null?h:[])),a.$$.dirty[0]&8)try{t(8,U=new Function("t","i","m","b",`
			try { 
        with (Math)
          return [${b}].flat()
			} catch(error){
				return [0];
			}`))}catch{t(8,U=()=>[0])}},[s,c,m,b,l,o,n,C,U,v,H,K,W,q,J,Y,F]}class Ve extends Ae{constructor(e){super();Te(this,e,Oe,Be,Re,{},null,[-1,-1])}}export{Ve as default};
