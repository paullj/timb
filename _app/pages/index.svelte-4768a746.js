import{M as Xe,N as Pe,O as Se,P as Ke,Q as ye,R as We,S as Ye,i as Ze,s as Ge,l as Ae,g as D,e as R,k as z,c as M,a as T,m as Q,d as f,b as d,T as O,H as h,f as he,U as pe,t as L,h as P,j as ke,V as Fe,W as ne,X as me,L as Ue,Y as Je,Z as xe,v as $e,_ as J,$ as qe,a0 as De,a1 as ge,a2 as et,a3 as ve,a4 as tt,a5 as st,a6 as nt}from"../chunks/vendor-9562570a.js";import{b as ot}from"../chunks/paths-4b3c6e7e.js";const fe=[{comments:["timb(re) - musical creative coding","click play and then on the dots above to hear more!"],code:"[[220,277,330,370][m%2+b%3],55*(r(3,8)[b]-1),110*(1+m%2),1/0]"},{comments:["each dot is a beat, to play a note","return a frequency from 1 to 10000 hz"],code:"440"},{comments:["frequencies greater than 0 play a triangle wave","while negative frequencies play a sawtooth wave"],code:"-440"},{comments:["return 0 for a kick drum","infinity for hi hats and negative infinity for snare"],code:"0"},{comments:["`m` is the current measure (0-7)","and `b`, the beat in the current mesasure (0-7)"],code:"(1 + m % 2) * 110 * [1, 2, 3, 4][b % 4]"},{comments:["`t` is for time","and `i` is index (0-63)"],code:"20 * (t % 50) * [1, 2, 3, 2][i % 4]"},{comments:["NaN, undefined and other non number values are rest notes","this allows for coding intesting rhythms"],code:"440 * [2, 1, NaN, 1][i % 4]"},{comments:["returning an array plays all frequencies as a chord","you can play a maximum of 4 notes at the same time"],code:"[[261.63, 329.628, 391.995], NaN][b % 4]"},{comments:["`f(b,i)` gives you `i` semitones from base frequency `b`","this is useful for making western tonal music (440Hz is a4)"],code:"[0, 4, 7, 4, 2, -2, 5, 4].map(n => f(440, n))[b % 8]"},{comments:["`r(o,p)` returns euclidean rhythms as an array of 0s and 1s","it spreads out `o` onsets across `p` pulses (more on /about)"],code:"[NaN, 0][r(3, 8)[b]]"},{comments:["no need for `Math.`, math functions are available in scope","this gives you more room for creativity"],code:"110 * sin(t) + 220 * cos(2 * t)"},{comments:["here is my attempt at twinkle twinkle little star","can you make it nicer/smaller/better?"],code:"[...'0077997~5544220~7755442~7755442'].map(n=>f(440,n))[i%32]"},{comments:["you are limited to 64 bytes, use creative ways to shorten","eg. `b^0` is equivalent to `b!=0`, every byte counts!"],code:"b^0?440:-220"},{comments:[" more examples:","a nice chord progression in c major"],code:"[0,5,7,2].map(n=>[0,16,7,12].map(x=>f(131,n+x)))[[1][i%2]*m%4]"},{comments:["how about some drums?","`1/0` is equal to infinity, useful for hi-hats and snares"],code:"[[,0][r(2+m%2,8)[b]],[-1/0][(b+2)%4],1/0,-10*(4+m%2)]"},{comments:["you can use `random()` to add probability to you music","combine it with logic operators to add variation to beats"],code:"[(b%4^0&&random()>.1)*-90,-(m%3+1)*30*[1,2,3][b%3],[360][b%5]]"},{comments:["now its your turn","have fun!"],code:"'*your next masterpiece*'"}],at=()=>{const n=Xe("__svelte__");return{page:{subscribe:n.page.subscribe},navigating:{subscribe:n.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:n.navigating.subscribe}},session:n.session}},lt={subscribe(n){return at().page.subscribe(n)}};class rt{constructor(){const e=new Pe({volume:0,pitchDecay:.2,octaves:2,oscillator:{type:"sine"},envelope:{attack:.001,decay:.3,sustain:.01,release:.1,attackCurve:"linear"}});this.membrane=e}connect(e){return this.membrane.connect(e),this}trigger(e){this.membrane.triggerAttackRelease("C1","8n",e)}}class ct{constructor(){const e=new Se({frequency:11e3,type:"lowpass"}),t=new Ke({volume:-8,noise:{type:"pink",playbackRate:3},envelope:{attack:.001,decay:.13,sustain:0,release:1}}).connect(e),s=new Pe({volume:-12,pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:1,sustain:.4,release:1.5,attackCurve:"exponential"}});this.noise=t,this.lpf=e,this.membrane=s}connect(e){return this.membrane.connect(e),this.lpf.connect(e),this}trigger(e){this.noise.triggerAttackRelease("8n",e),this.membrane.triggerAttackRelease(30,"8n",e)}}class it{constructor(){const e=new Se(1e4,"bandpass"),t=new ye(We,{volume:-12,envelope:{attack:.001,decay:.13,sustain:0,release:.1}}).connect(e);this.synth=t,this.highPass=e}connect(e){return this.highPass.connect(e),this}trigger(e){this.synth.triggerAttackRelease(1e3,"16n",e)}}function Be(n,e,t){const s=n.slice();return s[27]=e[t],s}function Oe(n,e,t){const s=n.slice();return s[30]=e[t],s[32]=t,s}function Ie(n,e,t){const s=n.slice();s[30]=e[t],s[36]=e,s[37]=t;const o=s[7]*K+s[8];s[33]=o;const r=s[32]*K+s[37];s[34]=r;const a=s[12](s[6]+(s[33]-s[34])*.25,s[34],s[32],s[37]).sort(n[21]);return s[35]=a,s}function Ce(n,e,t){const s=n.slice();s[30]=e[t],s[40]=t;const o=s[35][s[40]];return s[38]=o,s}function ut(n){let e;return{c(){e=L("play")},l(t){e=P(t,"play")},m(t,s){D(t,e,s)},d(t){t&&f(e)}}}function ht(n){let e;return{c(){e=L("pause")},l(t){e=P(t,"pause")},m(t,s){D(t,e,s)},d(t){t&&f(e)}}}function je(n){let e;return{c(){e=R("div"),this.h()},l(t){e=M(t,"DIV",{class:!0}),T(e).forEach(f),this.h()},h(){d(e,"class","note rest svelte-4tnalu")},m(t,s){D(t,e,s)},d(t){t&&f(e)}}}function He(n){let e;return{c(){e=R("div"),this.h()},l(t){e=M(t,"DIV",{class:!0,style:!0}),T(e).forEach(f),this.h()},h(){d(e,"class","note svelte-4tnalu"),he(e,"--index",n[40]),he(e,"--scale",n[14](n[35][n[40]],n[33]-n[34])),O(e,"overlay",n[40]>0),O(e,"blue",n[15](n[38])),O(e,"red",n[38]<0&&!n[15](n[38]))},m(t,s){D(t,e,s)},p(t,s){s[0]&4544&&he(e,"--scale",t[14](t[35][t[40]],t[33]-t[34])),s[0]&37312&&O(e,"blue",t[15](t[38])),s[0]&37312&&O(e,"red",t[38]<0&&!t[15](t[38]))},d(t){t&&f(e)}}}function Ve(n){let e,t,s={length:n[35].length||0},o=[];for(let a=0;a<s.length;a+=1)o[a]=He(Ce(n,s,a));let r=null;return s.length||(r=je()),{c(){e=R("div");for(let a=0;a<o.length;a+=1)o[a].c();r&&r.c(),t=z(),this.h()},l(a){e=M(a,"DIV",{class:!0});var b=T(e);for(let i=0;i<o.length;i+=1)o[i].l(b);r&&r.l(b),t=Q(b),b.forEach(f),this.h()},h(){d(e,"class","beat svelte-4tnalu"),O(e,"indicator",n[33]===n[34])},m(a,b){D(a,e,b);for(let i=0;i<o.length;i+=1)o[i].m(e,null);r&&r.m(e,null),h(e,t)},p(a,b){if(b[0]&53696){s={length:a[35].length||0};let i;for(i=0;i<s.length;i+=1){const S=Ce(a,s,i);o[i]?o[i].p(S,b):(o[i]=He(S),o[i].c(),o[i].m(e,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=s.length,s.length?r&&(r.d(1),r=null):r||(r=je(),r.c(),r.m(e,t))}b[0]&384&&O(e,"indicator",a[33]===a[34])},d(a){a&&f(e),pe(o,a),r&&r.d()}}}function ze(n){let e,t={length:K},s=[];for(let o=0;o<t.length;o+=1)s[o]=Ve(Ie(n,t,o));return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=Ae()},l(o){for(let r=0;r<s.length;r+=1)s[r].l(o);e=Ae()},m(o,r){for(let a=0;a<s.length;a+=1)s[a].m(o,r);D(o,e,r)},p(o,r){if(r[0]&53696){t={length:K};let a;for(a=0;a<t.length;a+=1){const b=Ie(o,t,a);s[a]?s[a].p(b,r):(s[a]=Ve(b),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(o){pe(s,o),o&&f(e)}}}function Qe(n){let e,t,s=n[27]+"",o;return{c(){e=R("label"),t=L("// "),o=L(s),this.h()},l(r){e=M(r,"LABEL",{for:!0,class:!0});var a=T(e);t=P(a,"// "),o=P(a,s),a.forEach(f),this.h()},h(){d(e,"for","code"),d(e,"class","comment svelte-4tnalu")},m(r,a){D(r,e,a),h(e,t),h(e,o)},p(r,a){a[0]&2048&&s!==(s=r[27]+"")&&ke(o,s)},d(r){r&&f(e)}}}function mt(n){let e,t,s,o,r,a,b,i,S=(n[1]?"unmute":"mute")+"",I,W,y,C,Y=(2*n[5]).toFixed(2)+"",q,x,oe,A,ae,p,F,le,re,B,ce,j,ie,ue,u,w,N,X,Z,k,$,ee;function te(l,m){return l[10]?ht:ut}let U=te(n),_=U(n),E={length:be},g=[];for(let l=0;l<E.length;l+=1)g[l]=ze(Oe(n,E,l));let H=n[11],v=[];for(let l=0;l<H.length;l+=1)v[l]=Qe(Be(n,H,l));return{c(){e=R("form"),t=R("button"),_.c(),s=z(),o=R("button"),r=L("stop"),b=z(),i=R("button"),I=L(S),W=z(),y=R("button"),C=L("volume ("),q=L(Y),x=L(")"),oe=z(),A=R("div");for(let l=0;l<g.length;l+=1)g[l].c();ae=z(),p=R("form"),F=R("label"),le=L("// hit `enter` to save your code in the URL"),re=z(),B=R("label"),ce=L("// click on the dots above or go to "),j=R("a"),ie=L("/about"),ue=L(" for more info"),u=z();for(let l=0;l<v.length;l+=1)v[l].c();w=z(),N=R("label"),X=L("(t,i,m,b) =>"),Z=z(),k=R("input"),this.h()},l(l){e=M(l,"FORM",{class:!0});var m=T(e);t=M(m,"BUTTON",{});var c=T(t);_.l(c),c.forEach(f),s=Q(m),o=M(m,"BUTTON",{});var G=T(o);r=P(G,"stop"),G.forEach(f),b=Q(m),i=M(m,"BUTTON",{class:!0});var Ee=T(i);I=P(Ee,S),Ee.forEach(f),W=Q(m),y=M(m,"BUTTON",{class:!0});var de=T(y);C=P(de,"volume ("),q=P(de,Y),x=P(de,")"),de.forEach(f),m.forEach(f),oe=Q(l),A=M(l,"DIV",{class:!0,style:!0});var Re=T(A);for(let se=0;se<g.length;se+=1)g[se].l(Re);Re.forEach(f),ae=Q(l),p=M(l,"FORM",{class:!0});var V=T(p);F=M(V,"LABEL",{for:!0,class:!0});var Me=T(F);le=P(Me,"// hit `enter` to save your code in the URL"),Me.forEach(f),re=Q(V),B=M(V,"LABEL",{for:!0,class:!0});var _e=T(B);ce=P(_e,"// click on the dots above or go to "),j=M(_e,"A",{id:!0,href:!0,class:!0});var Te=T(j);ie=P(Te,"/about"),Te.forEach(f),ue=P(_e," for more info"),_e.forEach(f),u=Q(V);for(let se=0;se<v.length;se+=1)v[se].l(V);w=Q(V),N=M(V,"LABEL",{id:!0,for:!0});var Le=T(N);X=P(Le,"(t,i,m,b) =>"),Le.forEach(f),Z=Q(V),k=M(V,"INPUT",{id:!0,name:!0,type:!0,spellcheck:!0,autocomplete:!0,maxlength:!0}),V.forEach(f),this.h()},h(){o.disabled=a=n[7]+n[8]===0&&!n[10],d(i,"class","mute-button"),O(i,"active",n[1]),d(y,"class","mute-button"),y.disabled=n[1],O(y,"active",n[1]),d(e,"class","controls svelte-4tnalu"),d(A,"class","container svelte-4tnalu"),he(A,"--beats",K),he(A,"--meausures",be),d(F,"for","code"),d(F,"class","comment focus-only svelte-4tnalu"),d(j,"id","about"),d(j,"href",""+(ot+"/about")),d(j,"class","svelte-4tnalu"),d(B,"for","code"),d(B,"class","comment focus-only svelte-4tnalu"),d(N,"id","label"),d(N,"for","code"),d(k,"id","input"),d(k,"name","code"),d(k,"type","text"),d(k,"spellcheck","false"),d(k,"autocomplete","off"),d(k,"maxlength","64"),d(p,"class","editor svelte-4tnalu")},m(l,m){D(l,e,m),h(e,t),_.m(t,null),h(e,s),h(e,o),h(o,r),h(e,b),h(e,i),h(i,I),h(e,W),h(e,y),h(y,C),h(y,q),h(y,x),D(l,oe,m),D(l,A,m);for(let c=0;c<g.length;c+=1)g[c].m(A,null);D(l,ae,m),D(l,p,m),h(p,F),h(F,le),h(p,re),h(p,B),h(B,ce),h(B,j),h(j,ie),h(B,ue),h(p,u);for(let c=0;c<v.length;c+=1)v[c].m(p,null);h(p,w),h(p,N),h(N,X),h(p,Z),h(p,k),Fe(k,n[4]),$||(ee=[ne(t,"click",me(n[17])),ne(o,"click",me(n[18])),ne(i,"click",me(n[19])),ne(y,"click",me(n[20])),ne(A,"click",n[22]),ne(k,"input",n[23]),ne(p,"submit",me(n[13]))],$=!0)},p(l,m){if(U!==(U=te(l))&&(_.d(1),_=U(l),_&&(_.c(),_.m(t,null))),m[0]&1408&&a!==(a=l[7]+l[8]===0&&!l[10])&&(o.disabled=a),m[0]&2&&S!==(S=(l[1]?"unmute":"mute")+"")&&ke(I,S),m[0]&2&&O(i,"active",l[1]),m[0]&32&&Y!==(Y=(2*l[5]).toFixed(2)+"")&&ke(q,Y),m[0]&2&&(y.disabled=l[1]),m[0]&2&&O(y,"active",l[1]),m[0]&53696){E={length:be};let c;for(c=0;c<E.length;c+=1){const G=Oe(l,E,c);g[c]?g[c].p(G,m):(g[c]=ze(G),g[c].c(),g[c].m(A,null))}for(;c<g.length;c+=1)g[c].d(1);g.length=E.length}if(m[0]&2048){H=l[11];let c;for(c=0;c<H.length;c+=1){const G=Be(l,H,c);v[c]?v[c].p(G,m):(v[c]=Qe(G),v[c].c(),v[c].m(p,w))}for(;c<v.length;c+=1)v[c].d(1);v.length=H.length}m[0]&16&&k.value!==l[4]&&Fe(k,l[4])},i:Ue,o:Ue,d(l){l&&f(e),_.d(),l&&f(oe),l&&f(A),pe(g,l),l&&f(ae),l&&f(p),pe(v,l),$=!1,Je(ee)}}}const we=1e4;let K=8,be=8;function Ne(n,e,t){return Math.min(Math.max(n,e),t)}function ft(n,e,t){let s,o;xe(n,lt,u=>t(24,o=u));let r=0,a=0,b=0,i=!1,S=!1,I=!1,W=0,y;$e(()=>{A(),window.f=(U,_)=>U*1.059463**_,window.r=(U,_)=>{for(var E=null,g=[],H=0;H<_;H++){var v=Math.floor(U/_*H);g.push(v===E?0:1),E=v}return g};const u=new ge(-.7),w=new ge(-.2),N=new ge(.2),X=new ge(.7),Z=new rt().connect(J()),k=new it().connect(u),$=new ct().connect(X),ee=new ye().connect(w);ee.set({volume:-8,envelope:{attack:.1,decay:.4,release:1}});const te=new ye().connect(N);te.set({detune:.1,volume:-16,oscillator:{type:"sawtooth"},envelope:{attack:.1,decay:.1}}),w.connect(J()),N.connect(J()),u.connect(J()),X.connect(J()),t(6,r=et()),ve.scheduleRepeat(U=>{t(6,r=U);let _=x(U,a*K+b,a,b);Array.isArray(_)&&_.forEach(E=>{F(E)?E>0?k.trigger("+0.1"):E<0?$.trigger("+0.1"):Z.trigger("+0.1"):E>0?ee.triggerAttackRelease(Ne(E,1,we),"8n","+0.1"):te.triggerAttackRelease(Ne(Math.abs(E),1,we),"8n","+0.1")}),t(7,a=(a+Math.floor((b+1)/K))%be),t(8,b=(b+1)%K)},"8n")});let C=0,Y=fe[0].comments,q=fe[0].code,x;const oe=()=>{let u=new URLSearchParams(o.url.searchParams.toString());u.set("code",q),history.pushState(null,"",`?${u.toString()}`)},A=()=>{o.url.searchParams.has("code")&&t(4,q=o.url.searchParams.get("code")),o.url.searchParams.has("bpm")&&t(0,ve.bpm.value=Ne(o.url.searchParams.get("bpm"),1,500),De)},ae=(u,w)=>{const N=Math.abs(w/(be*K));return F(u)?(2-tt(N)**2)/1.75*(u===0?1:u>0?.5:.8):st(1-Math.abs(u/we))*(1-N/2)},p=u=>Number.isNaN(u)||u==null,F=u=>u===0||!Number.isFinite(u),le=async()=>{i||(await nt(),t(9,i=!0)),ve.toggle("+0.1"),t(10,S=!S)},re=()=>{ve.stop(),t(10,S=!1),t(7,a=t(8,b=0))},B=()=>t(1,I=!I),ce=()=>t(2,W=(W+1)%4),j=(u,w)=>(F(u)&&(u=0),F(w)&&(w=0),w-u),ie=()=>t(3,C=Math.min(C+1,fe.length-1));function ue(){q=this.value,t(4,q),t(3,C)}return n.$$.update=()=>{var u,w,N,X,Z;n.$$.dirty[0]&4&&t(5,s=(W+1)/8),n.$$.dirty[0]&65571&&(y&&clearTimeout(y),(w=(u=J())==null?void 0:u.volume)==null||w.rampTo(qe(I?0:s),.3),t(16,y=setTimeout(()=>J().mute=I,300))),n.$$.dirty[0]&33&&((X=(N=J())==null?void 0:N.volume)==null||X.rampTo(qe(s),.3)),n.$$.dirty[0]&8&&(t(4,q=fe[C].code),t(11,Y=(Z=fe[C].comments)!=null?Z:[])),n.$$.dirty[0]&16&&t(12,x=(k,$,ee,te)=>{try{return new Function("t","i","m","b",`
          try { 
            with (Math)
              return [${q}];
          } catch(error){
            return [NaN];
          }`)(k,$,ee,te).flat().splice(0,4).map(_=>Number.parseFloat(_)).filter(_=>!p(_))}catch{return[NaN]}})},[De,I,W,C,q,s,r,a,b,i,S,Y,x,oe,ae,F,y,le,re,B,ce,j,ie,ue]}class _t extends Ye{constructor(e){super();Ze(this,e,ft,mt,Ge,{},null,[-1,-1])}}export{_t as default};
